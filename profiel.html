<?php
session_start();

if (!isset($_SESSION['loggedin'])){
    header("location: login.php");
    exit();
}

?>
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <link rel="icon" href="https://logos-download.com/wp-content/uploads/2016/05/Albert_Heijn_logo_ah.png">
    <meta name="viewport" content="with=device-width, initial-scale=1.0">
    <title>Profiel</title>
    <link rel="stylesheet" href= "style1.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
<section class="header6">
    <nav>
        <a href="home.php"><img src="images/AH-Logo.png" alt=""></a>
        <div class="nav-links" id="navLinks">
            <i class="fa fa-times" onclick="hideMenu()"></i>
            <ul>
                <li><a href="index.html">HOME</a></li>
                <li><a href="bonus.php">BONUS</a></li>
                <li><a href="profiel.php"><img src="images/Deafult-Profile-Pitcture.png" alt=""></a></li>
            </ul>
        </div>
        <i class="fa fa-bars" onclick="showMenu()"></i>
    </nav>
</section>

<section class="create">
    <?php require_once 'CRUD.php';?>

    <?php

    if (isset($_SESSION['message'])): ?>

    <div class="alert alert-<?=$_SESSION['msg_type']?>">
        <?php
            echo htmlentities($_SESSION['message']);
            unset($_SESSION['message']);
        ?>

    </div>

    <?php endif ?>
    <?php
        $host="localhost";
        $db_user="root";
        $password="";
        $db="Reserveringen";

        $con= mysqli_connect($host,$db_user,$password, $db)
        or die("Error: " . mysqli_connect_error());

        $result = $con->query("SELECT * FROM Gebruikers")
    or die($con->error);
    ?>



    <!--- Uitloggen van de gebruiker --->
    <div class="uitloggen">
        <form action="" method="POST">
            <input type="submit" name="loguit" value="Uitloggen">

            <?php
            if (isset($_POST['loguit'])){
                header("location: logout.php");
                exit();
            }
            ?>



            <!--- Tabel overzicht gebruikers --->
    </div>
    <div class="row justify-content-center">
        <h1>Gebruikers</h1>
        <table class="tabel">
            <thead>
            <tr>
                <th>Voornaam</th>
                <th>Achternaam</th>
                <th>Gebruikersnaam</th>
                <th colspan="2">Action</th>
            </tr>
            </thead>
            <?php while ($row = $result->fetch_assoc()): ?>
            <tr>
                <td><?php echo htmlentities($row['voornaam']);?></td>
                <td><?php echo htmlentities($row['achternaam']);?></td>
                <td><?php echo htmlentities($row['user']);?></td>
                <td>
                    <a href="profiel.php?edit=<?php echo htmlentities($row['id']);?>" class="edit-btn">Edit</a>
                    <a href="CRUD.php?delete=<?php echo htmlentities($row['id']);?>" class="delete-btn">Delete</a>
                </td>
            </tr>
            <?php endwhile; ?>
        </table>

    </div>


    <!--- Invoer velden voor het aanmaken van gebruiker --->
    <div class="filler">
        <form action="CRUD.php" method="POST">
            <input type="hidden" name="id" value="<?php echo htmlentities($id); ?>">
            <p>Voornaam</p>

            <input type="text" name="voornaam"
                   value="<?php echo htmlentities($vnaam); ?>" placeholder="Vul in">

            <p>Achternaam</p>
            <input type="text" name="achternaam"
                   value="<?php echo htmlentities($anaam); ?>" placeholder="Vul in">

            <p>Gebruikersnaam</p>
            <input type="text" name="user"
                   value="<?php echo htmlentities($gnaam); ?>" placeholder="Vul in">

            <p>Wachtwoord</p>
            <input type="password" name="wachtwoord"
                   value="<?php htmlentities($wachtw); ?>" placeholder="Vul in">
            <br>
            <?php
            if ($update == true): ?>
            <input type="submit" name="update" value="Update">
            <?php else: ?>
            <input type="submit" name="submit" value="Gebruiker aanmaken">
            <?php endif; ?>
            <br/>
            <span class="error"><?php echo $error;?></span>
        </form>
    </div>
</section>
</body>
</html>
